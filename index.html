<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P3 AI Risk Assessment Tool</title>
    <style>
        :root {
            /* Semantic Color System - Light Mode */
            --primary-color: #0f172a;
            --primary-dark: #020617;
            --primary-light: #334155;
            --secondary-color: #06b6d4;
            --accent-color: #8b5cf6;
            --accent-alt: #f59e0b;
            --background-gradient-start: #f8fafc;
            --background-gradient-end: #e0e7ff;
            --card-bg: rgba(255, 255, 255, 0.7);
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(148, 163, 184, 0.1);
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --shadow-color: rgba(0, 0, 0, 0.05);
            --shadow-hover: rgba(0, 0, 0, 0.1);
            --border-color: rgba(226, 232, 240, 0.8);
            --section-bg: rgba(248, 250, 252, 0.6);
            --input-bg: rgba(255, 255, 255, 0.9);
            --input-border: rgba(226, 232, 240, 1);
            --hover-bg: rgba(241, 245, 249, 0.8);
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            
            /* Fluid Typography Variables */
            --font-size-xs: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);
            --font-size-sm: clamp(0.875rem, 0.825rem + 0.25vw, 1rem);
            --font-size-base: clamp(1rem, 0.95rem + 0.25vw, 1.125rem);
            --font-size-lg: clamp(1.125rem, 1.05rem + 0.375vw, 1.25rem);
            --font-size-xl: clamp(1.25rem, 1.15rem + 0.5vw, 1.5rem);
            --font-size-2xl: clamp(1.5rem, 1.35rem + 0.75vw, 2rem);
            --font-size-3xl: clamp(2rem, 1.75rem + 1.25vw, 3rem);
            --font-size-4xl: clamp(2.5rem, 2rem + 2.5vw, 4rem);
            
            /* Spacing System */
            --space-xs: clamp(0.5rem, 0.45rem + 0.25vw, 0.75rem);
            --space-sm: clamp(0.75rem, 0.7rem + 0.25vw, 1rem);
            --space-md: clamp(1rem, 0.9rem + 0.5vw, 1.5rem);
            --space-lg: clamp(1.5rem, 1.3rem + 1vw, 2.5rem);
            --space-xl: clamp(2rem, 1.5rem + 2.5vw, 4rem);
            
            /* Border Radius */
            --radius-sm: 0.5rem;
            --radius-md: 0.75rem;
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            --radius-full: 9999px;
        }

        /* Dark Mode with prefers-color-scheme */
        @media (prefers-color-scheme: dark) {
            :root:not([data-theme="light"]) {
                --primary-color: #f8fafc;
                --primary-dark: #e2e8f0;
                --primary-light: #cbd5e1;
                --secondary-color: #22d3ee;
                --accent-color: #a78bfa;
                --accent-alt: #fbbf24;
                --background-gradient-start: #0f172a;
                --background-gradient-end: #1e1b4b;
                --card-bg: rgba(30, 41, 59, 0.7);
                --glass-bg: rgba(255, 255, 255, 0.03);
                --glass-border: rgba(148, 163, 184, 0.1);
                --text-primary: #f1f5f9;
                --text-secondary: #cbd5e1;
                --text-muted: #94a3b8;
                --shadow-color: rgba(0, 0, 0, 0.3);
                --shadow-hover: rgba(0, 0, 0, 0.5);
                --border-color: rgba(51, 65, 85, 0.8);
                --section-bg: rgba(30, 41, 59, 0.4);
                --input-bg: rgba(30, 41, 59, 0.9);
                --input-border: rgba(51, 65, 85, 1);
                --hover-bg: rgba(51, 65, 85, 0.6);
                --success-color: #34d399;
                --warning-color: #fbbf24;
                --error-color: #f87171;
            }
        }
        
        [data-theme="dark"] {
            --primary-color: #f8fafc;
            --primary-dark: #e2e8f0;
            --primary-light: #cbd5e1;
            --secondary-color: #22d3ee;
            --accent-color: #a78bfa;
            --accent-alt: #fbbf24;
            --background-gradient-start: #0f172a;
            --background-gradient-end: #1e1b4b;
            --card-bg: rgba(30, 41, 59, 0.7);
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(148, 163, 184, 0.1);
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --shadow-hover: rgba(0, 0, 0, 0.5);
            --border-color: rgba(51, 65, 85, 0.8);
            --section-bg: rgba(30, 41, 59, 0.4);
            --input-bg: rgba(30, 41, 59, 0.9);
            --input-border: rgba(51, 65, 85, 1);
            --hover-bg: rgba(51, 65, 85, 0.6);
            --success-color: #34d399;
            --warning-color: #fbbf24;
            --error-color: #f87171;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Modern Animations with purpose */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideInFromLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInFromRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }
            100% {
                background-position: 1000px 0;
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            font-size: var(--font-size-base);
            line-height: 1.6;
            background: linear-gradient(135deg, var(--background-gradient-start) 0%, var(--background-gradient-end) 100%);
            background-attachment: fixed;
            margin: 0;
            padding: var(--space-md);
            min-block-size: 100vh;
            color: var(--text-primary);
            transition: background 0.3s cubic-bezier(0.4, 0, 0.2, 1), color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Ambient background effects */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(6, 182, 212, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(245, 158, 11, 0.08) 0%, transparent 70%);
            pointer-events: none;
            z-index: 0;
            animation: float 20s ease-in-out infinite;
        }

        .logo-container {
            text-align: center;
            padding-block: var(--space-lg);
            padding-inline: var(--space-md);
            position: relative;
            z-index: 1;
            animation: fadeInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .logo-container img {
            block-size: clamp(60px, 5vw + 40px, 100px);
            inline-size: auto;
            filter: drop-shadow(0 4px 20px rgba(139, 92, 246, 0.3));
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), filter 0.3s ease;
            will-change: transform;
        }

        .logo-container img:hover {
            transform: scale(1.05) translateY(-5px);
            filter: drop-shadow(0 8px 30px rgba(139, 92, 246, 0.5));
        }

        /* Modern CSS Grid "Bento Box" Layout */
        .container {
            max-inline-size: min(1400px, 100% - var(--space-lg));
            margin-inline: auto;
            margin-block-end: var(--space-xl);
            background: var(--card-bg);
            border-radius: var(--radius-xl);
            box-shadow: 
                0 20px 60px var(--shadow-color),
                0 0 0 1px var(--glass-border) inset;
            overflow: hidden;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            animation: scaleIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 1;
            border: 1px solid var(--glass-border);
        }

        .container::before {
            content: '';
            position: absolute;
            inset-block-start: 0;
            inset-inline: 0;
            block-size: 200px;
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-color) 100%);
            opacity: 0.05;
            pointer-events: none;
        }

        .language-toggle {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-md) var(--space-lg);
            background: transparent;
            animation: slideInFromRight 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .theme-toggle, .language-toggle button {
            padding: var(--space-sm) var(--space-md);
            border: 2px solid var(--border-color);
            background: var(--glass-bg);
            color: var(--text-secondary);
            border-radius: var(--radius-full);
            cursor: pointer;
            font-weight: 600;
            font-size: var(--font-size-sm);
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
            will-change: transform;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .theme-toggle::before, .language-toggle button::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, var(--secondary-color), var(--accent-color));
            opacity: 0;
            transition: opacity 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
        }

        .theme-toggle:hover, .language-toggle button:hover {
            color: white;
            border-color: var(--secondary-color);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 10px 25px var(--shadow-hover);
        }

        .theme-toggle:hover::before, .language-toggle button:hover::before {
            opacity: 1;
        }

        .theme-toggle:active, .language-toggle button:active {
            transform: translateY(0) scale(0.98);
        }

        .theme-toggle:focus-visible, .language-toggle button:focus-visible {
            outline: 3px solid var(--secondary-color);
            outline-offset: 3px;
        }

        .header {
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-color) 100%);
            color: white;
            padding-block: var(--space-xl);
            padding-inline: var(--space-lg);
            text-align: center;
            position: relative;
            overflow: hidden;
            animation: slideInFromLeft 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .header::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        .header::after {
            content: '';
            position: absolute;
            inset-block-end: 0;
            inset-inline: 0;
            block-size: 4px;
            background: linear-gradient(90deg, 
                rgba(255, 255, 255, 0.3) 0%, 
                rgba(255, 255, 255, 0.6) 50%, 
                rgba(255, 255, 255, 0.3) 100%);
            background-size: 200% 100%;
            animation: shimmer 2s linear infinite;
        }

        .header h1 {
            margin-block-end: var(--space-sm);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: var(--font-size-3xl);
            font-weight: 700;
            letter-spacing: -0.02em;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 20px rgba(0, 0, 0, 0.2);
        }

        .header p {
            margin: 0;
            opacity: 0.95;
            font-size: var(--font-size-lg);
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        .tabs {
            display: flex;
            background: var(--glass-bg);
            border-block-end: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            position: relative;
            overflow-x: auto;
            scrollbar-width: none;
            gap: var(--space-xs);
        }

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tab {
            flex: 1;
            padding-block: var(--space-md);
            padding-inline: var(--space-sm);
            text-align: center;
            cursor: pointer;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-weight: 600;
            font-size: var(--font-size-sm);
            color: var(--text-muted);
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            border-block-end: 3px solid transparent;
            position: relative;
            min-inline-size: 150px;
            background: transparent;
        }

        .tab::before {
            content: '';
            position: absolute;
            inset-block-end: 0;
            inset-inline: 0;
            block-size: 3px;
            background: linear-gradient(90deg, var(--secondary-color), var(--accent-color));
            transform: scaleX(0);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .tab:hover {
            background: var(--hover-bg);
            color: var(--text-secondary);
            transform: translateY(-2px);
        }

        .tab.active {
            color: var(--secondary-color);
            background: transparent;
        }

        .tab.active::before {
            transform: scaleX(1);
        }
        
        .tab:focus-visible {
            outline: 3px solid var(--secondary-color);
            outline-offset: -3px;
        }

        .content {
            padding: var(--space-xl) var(--space-lg);
            animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Bento Box Grid Layout */
        .form-grid {
            display: grid;
            gap: var(--space-lg);
            grid-template-columns: repeat(auto-fit, minmax(min(100%, 400px), 1fr));
        }

        .form-section {
            background: var(--section-bg);
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            border-inline-start: 4px solid var(--secondary-color);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .form-section::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent 0%, rgba(6, 182, 212, 0.02) 100%);
            pointer-events: none;
        }

        .form-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            border-inline-start-width: 6px;
        }

        .section-title {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: var(--font-size-xl);
            font-weight: 700;
            color: var(--text-primary);
            margin-block-end: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            position: relative;
        }

        .section-title::before {
            content: '';
            inline-size: 4px;
            block-size: 24px;
            background: linear-gradient(180deg, var(--secondary-color), var(--accent-color));
            border-radius: var(--radius-sm);
        }

        .form-group {
            margin-block-end: var(--space-md);
            animation: slideInFromLeft 0.5s cubic-bezier(0.4, 0, 0.2, 1) backwards;
        }

        .form-group:nth-child(2) { animation-delay: 0.05s; }
        .form-group:nth-child(3) { animation-delay: 0.1s; }
        .form-group:nth-child(4) { animation-delay: 0.15s; }

        .form-group:last-child {
            margin-block-end: 0;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: var(--text-primary);
            margin-block-end: var(--space-xs);
            font-size: var(--font-size-sm);
            transition: color 0.2s ease;
        }

        select, input {
            inline-size: 100%;
            padding: var(--space-sm) var(--space-md);
            border: 2px solid var(--input-border);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            background: var(--input-bg);
            color: var(--text-primary);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        select:hover, input:hover {
            border-color: var(--secondary-color);
            background: var(--hover-bg);
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 
                0 0 0 4px rgba(6, 182, 212, 0.1),
                0 4px 20px rgba(6, 182, 212, 0.15);
            transform: translateY(-2px);
        }
        
        select:focus-visible, input:focus-visible {
            outline: 3px solid var(--secondary-color);
            outline-offset: 2px;
        }
        
        select[multiple] {
            block-size: auto;
            min-block-size: 120px;
            padding: var(--space-sm);
        }

        select option {
            padding: var(--space-sm);
            border-radius: var(--radius-sm);
            margin-block: 2px;
        }

        select option:checked {
            background: linear-gradient(90deg, var(--secondary-color), var(--accent-color));
            color: white;
        }

        .result-card {
            background: var(--card-bg);
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            margin-block-end: var(--space-md);
            border: 2px solid var(--border-color);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            animation: scaleIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) backwards;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .result-card:nth-child(1) { animation-delay: 0.05s; }
        .result-card:nth-child(2) { animation-delay: 0.1s; }
        .result-card:nth-child(3) { animation-delay: 0.15s; }
        .result-card:nth-child(4) { animation-delay: 0.2s; }
        .result-card:nth-child(5) { animation-delay: 0.25s; }

        .result-card::before {
            content: '';
            position: absolute;
            inset-block-start: 0;
            inset-inline-start: 0;
            inline-size: 4px;
            block-size: 100%;
            background: linear-gradient(180deg, var(--secondary-color), var(--accent-color));
        }

        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            border-color: var(--secondary-color);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-block-end: var(--space-md);
            flex-wrap: wrap;
            gap: var(--space-sm);
        }

        .result-title {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: var(--font-size-xl);
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .risk-badge {
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-full);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-weight: 700;
            font-size: var(--font-size-xs);
            letter-spacing: 0.05em;
            text-transform: uppercase;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .risk-badge:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .risk-critical { 
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }
        .risk-high { 
            background: linear-gradient(135deg, #f59e0b 0%, #ea580c 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
        }
        .risk-medium { 
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #0f172a;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
        }
        .risk-low { 
            background: linear-gradient(135deg, #84cc16 0%, #65a30d 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(132, 204, 22, 0.4);
        }
        .risk-minimal { 
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }

        .measure-item {
            background: var(--section-bg);
            padding: var(--space-md);
            margin-block-end: var(--space-sm);
            border-inline-start: 4px solid var(--secondary-color);
            border-radius: var(--radius-md);
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            animation: slideInFromLeft 0.5s cubic-bezier(0.4, 0, 0.2, 1) backwards;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.03);
        }

        .measure-item:nth-child(2) { animation-delay: 0.05s; }
        .measure-item:nth-child(3) { animation-delay: 0.1s; }
        .measure-item:nth-child(4) { animation-delay: 0.15s; }
        .measure-item:nth-child(5) { animation-delay: 0.2s; }
        .measure-item:nth-child(6) { animation-delay: 0.25s; }

        .measure-item:hover {
            transform: translateX(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border-inline-start-width: 6px;
        }

        .measure-title {
            font-weight: 700;
            color: var(--text-primary);
            margin-block-end: var(--space-xs);
            font-size: var(--font-size-base);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .action-buttons {
            display: flex;
            gap: var(--space-sm);
            justify-content: center;
            padding: var(--space-xl) var(--space-lg);
            background: var(--glass-bg);
            border-block-start: 1px solid var(--border-color);
            flex-wrap: wrap;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .btn {
            padding: var(--space-sm) var(--space-xl);
            border: none;
            border-radius: var(--radius-full);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: var(--font-size-base);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            will-change: transform;
        }

        .btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-100%);
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn:hover::before {
            transform: translateX(100%);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-color) 100%);
            color: white;
            border: 2px solid transparent;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(6, 182, 212, 0.4);
        }

        .btn-primary:active {
            transform: translateY(-1px);
        }
        
        .btn-primary:focus-visible {
            outline: 3px solid var(--secondary-color);
            outline-offset: 3px;
        }

        .btn-secondary {
            background: var(--card-bg);
            color: var(--secondary-color);
            border: 2px solid var(--secondary-color);
        }

        .btn-secondary:hover {
            background: var(--secondary-color);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(6, 182, 212, 0.3);
        }

        .btn-secondary:active {
            transform: translateY(-1px);
        }
        
        .btn-secondary:focus-visible {
            outline: 3px solid var(--secondary-color);
            outline-offset: 3px;
        }

        .info-box {
            background: linear-gradient(135deg, rgba(219, 234, 254, 0.6) 0%, rgba(191, 219, 254, 0.6) 100%);
            padding: var(--space-md);
            border-radius: var(--radius-md);
            margin-block-start: var(--space-md);
            font-size: var(--font-size-sm);
            color: var(--text-primary);
            border-inline-start: 4px solid #3b82f6;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: all 0.2s ease;
        }

        [data-theme="dark"] .info-box {
            background: linear-gradient(135deg, rgba(30, 58, 138, 0.6) 0%, rgba(30, 64, 175, 0.6) 100%);
            color: var(--text-secondary);
        }
        
        @media (prefers-color-scheme: dark) {
            :root:not([data-theme="light"]) .info-box {
                background: linear-gradient(135deg, rgba(30, 58, 138, 0.6) 0%, rgba(30, 64, 175, 0.6) 100%);
                color: var(--text-secondary);
            }
        }

        .info-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.2);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .tab-content.active {
            display: block;
        }

        .empty-state {
            text-align: center;
            padding-block: var(--space-xl);
            padding-inline: var(--space-md);
            color: var(--text-muted);
            animation: fadeIn 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .empty-state-icon {
            font-size: clamp(3rem, 5vw, 4rem);
            margin-block-end: var(--space-md);
            display: inline-block;
            animation: float 3s ease-in-out infinite;
        }

        .empty-state p {
            font-size: var(--font-size-lg);
            font-weight: 500;
        }

        /* Mobile-First Responsive Design with min-width queries */
        @media (min-width: 768px) {
            body {
                padding: var(--space-lg);
            }
            
            .form-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (min-width: 1024px) {
            .container {
                border-radius: calc(var(--radius-xl) * 1.5);
            }
        }

        @media (max-width: 767px) {
            .logo-container img {
                block-size: 60px;
            }

            .container {
                border-radius: var(--radius-lg);
            }

            .header {
                padding-block: var(--space-lg);
                padding-inline: var(--space-md);
            }

            .header h1 {
                font-size: var(--font-size-2xl);
            }

            .header p {
                font-size: var(--font-size-base);
            }

            .tabs {
                flex-wrap: nowrap;
                overflow-x: auto;
            }

            .tab {
                min-inline-size: 120px;
                padding-block: var(--space-sm);
                padding-inline: var(--space-xs);
                font-size: var(--font-size-xs);
            }

            .content {
                padding: var(--space-md);
            }

            .form-section {
                padding: var(--space-md);
            }

            .section-title {
                font-size: var(--font-size-lg);
            }

            .action-buttons {
                padding: var(--space-md);
                flex-direction: column;
            }

            .btn {
                inline-size: 100%;
            }

            .result-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .language-toggle {
                padding: var(--space-sm) var(--space-md);
                flex-wrap: wrap;
            }
        }

        /* Accessibility improvements - WCAG 2.1 AA */
        *:focus-visible {
            outline: 3px solid var(--secondary-color);
            outline-offset: 3px;
            transition: outline-offset 0.2s ease;
        }
        
        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* Print styles */
        @media print {
            body {
                background: white;
            }

            .language-toggle,
            .theme-toggle,
            .action-buttons,
            .tabs {
                display: none;
            }

            .container {
                box-shadow: none;
            }
        }

        /* Smooth custom scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--section-bg);
            border-radius: var(--radius-sm);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary-color);
            border-radius: var(--radius-sm);
            transition: background 0.2s ease;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-color);
        }
        
        /* Ensure high contrast for accessibility */
        @media (prefers-contrast: high) {
            :root {
                --border-color: rgba(0, 0, 0, 0.3);
                --text-muted: #334155;
            }
            
            [data-theme="dark"] {
                --border-color: rgba(255, 255, 255, 0.3);
                --text-muted: #cbd5e1;
            }
        }
        
        /* Skip to content link for screen readers */
        .skip-to-content {
            position: absolute;
            inset-block-start: -40px;
            inset-inline-start: 0;
            background: var(--secondary-color);
            color: white;
            padding: var(--space-sm) var(--space-md);
            text-decoration: none;
            border-radius: 0 0 var(--radius-sm) 0;
            z-index: 100;
        }
        
        .skip-to-content:focus {
            inset-block-start: 0;
        }
    </style>
</head>
<body>
<a href="#main-content" class="skip-to-content">Skip to main content</a>
<div class="logo-container">
    <img src="P3_lemonsplash.png" alt="P3 Logo - AI Risk Assessment">
</div>
    <div class="container">
        <nav class="language-toggle" aria-label="Language and theme controls">
            <button class="theme-toggle" onclick="toggleTheme()" id="themeBtn" aria-label="Toggle dark mode" aria-pressed="false">üåô Dark Mode</button>
            <button onclick="toggleLanguage()" id="languageBtn" aria-label="Switch language">üá©üá™ Deutsch</button>
        </nav>
        
        <header class="header">
            <h1 id="headerTitle">P3 AI Risk Assessment Tool</h1>
            <p id="headerSubtitle">Strategic Assessment of AI Systems for Consulting Projects</p>
        </header>
        
        <nav class="tabs" role="tablist" aria-label="Assessment sections">
            <button class="tab active" onclick="showTab('assessment')" data-tab="assessment" role="tab" aria-selected="true" aria-controls="assessment" id="tab-assessment">Assessment</button>
            <button class="tab" onclick="showTab('results')" data-tab="results" role="tab" aria-selected="false" aria-controls="results" id="tab-results">Risk Analysis</button>
            <button class="tab" onclick="showTab('measures')" data-tab="measures" role="tab" aria-selected="false" aria-controls="measures" id="tab-measures">Recommendations</button>
        </nav>

        <main id="main-content">
        <article id="assessment" class="tab-content active" role="tabpanel" aria-labelledby="tab-assessment">
            <div class="content">
                <div class="form-grid">
                    <div class="form-section">
                        <h3 class="section-title" data-i18n="section.context">Project & AI System Context</h3>
                        
                        <div class="form-group">
                            <label class="form-label" for="projectType" data-i18n="label.projectType">Project Type / Area:</label>
                            <select id="projectType" onchange="calculateRisk()" aria-required="true">
                                <option value="" data-i18n="option.pleaseSelect">Please select...</option>
                                <option value="strategy" data-i18n="option.strategy">Strategy Consulting & Business Development</option>
                                <option value="digital_transformation" data-i18n="option.digitalTransformation">Digital Transformation</option>
                                <option value="process_optimization" data-i18n="option.processOptimization">Process Optimization & Change Management</option>
                                <option value="software_development" data-i18n="option.softwareDevelopment">Software Development & Implementation</option>
                                <option value="data_analytics" data-i18n="option.dataAnalytics">Data Analytics & AI Solutions</option>
                                <option value="automotive" data-i18n="option.automotive">Automotive Engineering & Mobility</option>
                                <option value="internal_operations" data-i18n="option.internalOperations">Internal P3 Operations</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="aiTool" data-i18n="label.aiTool">AI Tool / System:</label>
                            <select id="aiTool" onchange="calculateRisk()" aria-required="true">
                                <option value="" data-i18n="option.pleaseSelect">Please select...</option>
                                <optgroup label="‚úÖ Approved Tools">
                                    <option value="m365_copilot" data-i18n="option.m365Copilot">M365 Copilot</option>
                                    <option value="ai_builder" data-i18n="option.aiBuilder">AI Builder in Power Platform</option>
                                </optgroup>
                                <optgroup label="‚ö†Ô∏è Requires IT Approval">
                                    <option value="chatgpt" data-i18n="option.chatgpt">ChatGPT (OpenAI)</option>
                                    <option value="gpt4" data-i18n="option.gpt4">GPT-4 / GPT-4o (OpenAI)</option>
                                    <option value="claude" data-i18n="option.claude">Claude (Anthropic)</option>
                                    <option value="gemini" data-i18n="option.gemini">Google Gemini / Bard</option>
                                    <option value="github_copilot" data-i18n="option.githubCopilot">GitHub Copilot</option>
                                    <option value="azure_openai" data-i18n="option.azureOpenai">Azure OpenAI Service</option>
                                    <option value="aws_bedrock" data-i18n="option.awsBedrock">AWS Bedrock</option>
                                    <option value="huggingface" data-i18n="option.huggingface">HuggingFace Models</option>
                                    <option value="midjourney" data-i18n="option.midjourney">Midjourney / DALL-E (Image Gen)</option>
                                    <option value="jasper" data-i18n="option.jasper">Jasper AI</option>
                                    <option value="notion_ai" data-i18n="option.notionAi">Notion AI</option>
                                    <option value="perplexity" data-i18n="option.perplexity">Perplexity AI</option>
                                    <option value="other" data-i18n="option.otherAI">Other AI System</option>
                                </optgroup>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="aiUseCase" data-i18n="label.aiUseCase">AI Use Case:</label>
                            <select id="aiUseCase" onchange="calculateRisk()" multiple aria-required="true">
                                <option value="" data-i18n="option.pleaseSelect">Please select...</option>
                                <option value="client_advisory" data-i18n="option.clientAdvisory">Client Advisory & Insight Generation</option>
                                <option value="predictive_analytics" data-i18n="option.predictiveAnalytics">Predictive Analytics & Forecasting</option>
                                <option value="automation" data-i18n="option.automation">Process Automation</option>
                                <option value="decision_support" data-i18n="option.decisionSupport">Decision Support System</option>
                                <option value="nlp_analysis" data-i18n="option.nlpAnalysis">NLP & Document Analysis</option>
                                <option value="code_generation" data-i18n="option.codeGeneration">Code Generation & Testing</option>
                                <option value="resource_allocation" data-i18n="option.resourceAllocation">Resource & Project Allocation</option>
                                <option value="risk_assessment" data-i18n="option.riskAssessment">Risk Assessment & Compliance</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="dataType" data-i18n="label.dataType">Processed Data Types:</label>
                            <select id="dataType" onchange="calculateRisk()" multiple aria-required="true">
                                <option value="" data-i18n="option.pleaseSelect">Please select...</option>
                                <option value="public_only" data-i18n="option.publicOnly">Public data only</option>
                                <option value="company_general" data-i18n="option.companyGeneral">General company data (anonymized)</option>
                                <option value="client_confidential" data-i18n="option.clientConfidential">Confidential client data</option>
                                <option value="strategic_sensitive" data-i18n="option.strategicSensitive">Strategically sensitive information</option>
                                <option value="personal_data" data-i18n="option.personalData">Personal data (employees/clients)</option>
                                <option value="special_categories" data-i18n="option.specialCategories">Special categories of personal data</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3 class="section-title" data-i18n="section.properties">AI System Properties</h3>
                        
                        <div class="form-group">
                            <label class="form-label" for="autonomy" data-i18n="label.autonomy">Level of Autonomy:</label>
                            <select id="autonomy" onchange="calculateRisk()" aria-required="true">
                                <option value="" data-i18n="option.pleaseSelect">Please select...</option>
                                <option value="support_only" data-i18n="option.supportOnly">Support: AI generates suggestions/insights</option>
                                <option value="interactive" data-i18n="option.interactive">Interactive: AI communicates with stakeholders</option>
                                <option value="semi_automated" data-i18n="option.semiAutomated">Semi-automated: AI makes preliminary decisions</option>
                                <option value="automated" data-i18n="option.automated">Automated: AI makes final decisions</option>
                                <option value="critical_automated" data-i18n="option.criticalAutomated">Critical: AI makes high-impact decisions</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="impact" data-i18n="label.impact">Impact Scope:</label>
                            <select id="impact" onchange="calculateRisk()" aria-required="true">
                                <option value="" data-i18n="option.pleaseSelect">Please select...</option>
                                <option value="internal_efficiency" data-i18n="option.internalEfficiency">Internal efficiency (low impact)</option>
                                <option value="project_support" data-i18n="option.projectSupport">Project support (medium impact)</option>
                                <option value="client_deliverable" data-i18n="option.clientDeliverable">Client deliverable (high impact)</option>
                                <option value="strategic_decision" data-i18n="option.strategicDecision">Strategic decision basis</option>
                                <option value="critical_operations" data-i18n="option.criticalOperations">Critical business processes</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="transparency" data-i18n="label.transparency">AI System Transparency:</label>
                            <select id="transparency" onchange="calculateRisk()" aria-required="true">
                                <option value="" data-i18n="option.pleaseSelect">Please select...</option>
                                <option value="high" data-i18n="option.transparencyHigh">High: Decisions fully traceable</option>
                                <option value="medium" data-i18n="option.transparencyMedium">Medium: Key factors explainable</option>
                                <option value="low" data-i18n="option.transparencyLow">Low: Black-box system</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="info-box" id="infoBox1">
                    <strong>‚ö†Ô∏è P3 AI Policy:</strong> Currently, only the following AI tools are approved for use:
                    <ul style="margin: 10px 0 0 0; padding-left: 20px;">
                        <li><strong>AI Builder in Power Platform</strong> - for automation and intelligent workflows</li>
                        <li><strong>M365 Copilot</strong> - for productivity enhancement in Microsoft 365</li>
                    </ul>
                    All other AI systems (including ChatGPT, Claude, GitHub Copilot, etc.) <strong>require IT approval</strong> before use. Please contact the IT department for assessment.
                </div>
                
                <div class="info-box" style="margin-top: 15px;" id="infoBox2">
                    <strong data-i18n="info.note">Note:</strong> <span data-i18n="info.disclaimer">This tool provides an initial risk assessment of AI systems in the context of P3 consulting projects, considering the EU AI Act and GDPR.</span>
                </div>
            </div>
        </article>

        <article id="results" class="tab-content" role="tabpanel" aria-labelledby="tab-results">
            <div class="content">
                <div id="resultsContent">
                    <div class="empty-state">
                        <div class="empty-state-icon" role="img" aria-label="Chart icon">üìä</div>
                        <p data-i18n="empty.results">Please complete the assessment first.</p>
                    </div>
                </div>
            </div>
        </article>

        <article id="measures" class="tab-content" role="tabpanel" aria-labelledby="tab-measures">
            <div class="content">
                <div id="measuresContent">
                    <div class="empty-state">
                        <div class="empty-state-icon" role="img" aria-label="Checkmark icon">‚úÖ</div>
                        <p data-i18n="empty.measures">Please complete the assessment first.</p>
                    </div>
                </div>
            </div>
        </article>
        </main>

        <footer class="action-buttons">
            <button class="btn btn-primary" onclick="downloadPDF()" aria-label="Export assessment as CSV"><span data-i18n="btn.export">üìÑ Export Assessment (CSV)</span></button>
            <button class="btn btn-secondary" onclick="resetForm()" aria-label="Start new assessment"><span data-i18n="btn.reset">üîÑ New Assessment</span></button>
        </footer>
    </div>

    <script>
        let currentAssessment = null;
        let currentLanguage = 'en'; // Default language
        let currentTheme = 'light'; // Default theme
        
        // Define approved AI tools list
        const APPROVED_AI_TOOLS = ['m365_copilot', 'ai_builder'];
        
        // Navigation delay for smooth transition when auto-navigating to results
        const AUTO_NAVIGATION_DELAY_MS = 300;
        
        // Maximum risk score components: autonomy(5) + data(5) + impact(5) + transparency(2) + unapproved_tool(3) = 20
        const MAX_RISK_SCORE = 20;
        
        // Risk scoring weights
        const AUTONOMY_SCORES = {
            'support_only': 1,
            'interactive': 2,
            'semi_automated': 3,
            'automated': 4,
            'critical_automated': 5
        };
        
        const IMPACT_SCORES = {
            'internal_efficiency': 1,
            'project_support': 2,
            'client_deliverable': 3,
            'strategic_decision': 4,
            'critical_operations': 5
        };
        
        const DATA_SCORES = {
            'public_only': 0,
            'company_general': 1,
            'client_confidential': 2,
            'strategic_sensitive': 3,
            'personal_data': 4,
            'special_categories': 5
        };

        // Theme toggle function with system preference detection
        function toggleTheme() {
            const html = document.documentElement;
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', currentTheme);
            localStorage.setItem('theme', currentTheme);
            
            const themeBtn = document.getElementById('themeBtn');
            if (currentTheme === 'dark') {
                themeBtn.textContent = '‚òÄÔ∏è Light Mode';
                themeBtn.setAttribute('aria-pressed', 'true');
            } else {
                themeBtn.textContent = 'üåô Dark Mode';
                themeBtn.setAttribute('aria-pressed', 'false');
            }
        }
        
        // Initialize theme based on system preference or saved preference
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            if (savedTheme) {
                currentTheme = savedTheme;
            } else if (prefersDark) {
                currentTheme = 'dark';
            } else {
                currentTheme = 'light';
            }
            
            document.documentElement.setAttribute('data-theme', currentTheme);
            const themeBtn = document.getElementById('themeBtn');
            if (currentTheme === 'dark') {
                themeBtn.textContent = '‚òÄÔ∏è Light Mode';
                themeBtn.setAttribute('aria-pressed', 'true');
            } else {
                themeBtn.textContent = 'üåô Dark Mode';
                themeBtn.setAttribute('aria-pressed', 'false');
            }
        }
        
        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            if (!localStorage.getItem('theme')) {
                currentTheme = e.matches ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', currentTheme);
                const themeBtn = document.getElementById('themeBtn');
                if (currentTheme === 'dark') {
                    themeBtn.textContent = '‚òÄÔ∏è Light Mode';
                    themeBtn.setAttribute('aria-pressed', 'true');
                } else {
                    themeBtn.textContent = 'üåô Dark Mode';
                    themeBtn.setAttribute('aria-pressed', 'false');
                }
            }
        });

        const translations = {
            en: {
                headerTitle: 'P3 AI Risk Assessment Tool',
                headerSubtitle: 'Strategic Assessment of AI Systems for Consulting Projects',
                'tab.assessment': 'Assessment',
                'tab.results': 'Risk Analysis',
                'tab.measures': 'Recommendations',
                'section.context': 'Project & AI System Context',
                'section.properties': 'AI System Properties',
                'label.projectType': 'Project Type / Area:',
                'label.aiTool': 'AI Tool / System:',
                'label.aiUseCase': 'AI Use Case:',
                'label.dataType': 'Processed Data Types:',
                'label.autonomy': 'Level of Autonomy:',
                'label.impact': 'Impact Scope:',
                'label.transparency': 'AI System Transparency:',
                'option.pleaseSelect': 'Please select...',
                'option.strategy': 'Strategy Consulting & Business Development',
                'option.digitalTransformation': 'Digital Transformation',
                'option.processOptimization': 'Process Optimization & Change Management',
                'option.softwareDevelopment': 'Software Development & Implementation',
                'option.dataAnalytics': 'Data Analytics & AI Solutions',
                'option.automotive': 'Automotive Engineering & Mobility',
                'option.internalOperations': 'Internal P3 Operations',
                'option.m365Copilot': 'M365 Copilot',
                'option.aiBuilder': 'AI Builder in Power Platform',
                'option.chatgpt': 'ChatGPT (OpenAI)',
                'option.gpt4': 'GPT-4 / GPT-4o (OpenAI)',
                'option.claude': 'Claude (Anthropic)',
                'option.gemini': 'Google Gemini / Bard',
                'option.githubCopilot': 'GitHub Copilot',
                'option.azureOpenai': 'Azure OpenAI Service',
                'option.awsBedrock': 'AWS Bedrock',
                'option.huggingface': 'HuggingFace Models',
                'option.midjourney': 'Midjourney / DALL-E (Image Gen)',
                'option.jasper': 'Jasper AI',
                'option.notionAi': 'Notion AI',
                'option.perplexity': 'Perplexity AI',
                'option.otherAI': 'Other AI System',
                'option.clientAdvisory': 'Client Advisory & Insight Generation',
                'option.predictiveAnalytics': 'Predictive Analytics & Forecasting',
                'option.automation': 'Process Automation',
                'option.decisionSupport': 'Decision Support System',
                'option.nlpAnalysis': 'NLP & Document Analysis',
                'option.codeGeneration': 'Code Generation & Testing',
                'option.resourceAllocation': 'Resource & Project Allocation',
                'option.riskAssessment': 'Risk Assessment & Compliance',
                'option.publicOnly': 'Public data only',
                'option.companyGeneral': 'General company data (anonymized)',
                'option.clientConfidential': 'Confidential client data',
                'option.strategicSensitive': 'Strategically sensitive information',
                'option.personalData': 'Personal data (employees/clients)',
                'option.specialCategories': 'Special categories of personal data',
                'option.supportOnly': 'Support: AI generates suggestions/insights',
                'option.interactive': 'Interactive: AI communicates with stakeholders',
                'option.semiAutomated': 'Semi-automated: AI makes preliminary decisions',
                'option.automated': 'Automated: AI makes final decisions',
                'option.criticalAutomated': 'Critical: AI makes high-impact decisions',
                'option.internalEfficiency': 'Internal efficiency (low impact)',
                'option.projectSupport': 'Project support (medium impact)',
                'option.clientDeliverable': 'Client deliverable (high impact)',
                'option.strategicDecision': 'Strategic decision basis',
                'option.criticalOperations': 'Critical business processes',
                'option.transparencyHigh': 'High: Decisions fully traceable',
                'option.transparencyMedium': 'Medium: Key factors explainable',
                'option.transparencyLow': 'Low: Black-box system',
                'info.note': 'Note:',
                'info.disclaimer': 'This tool provides an initial risk assessment of AI systems in the context of P3 consulting projects, considering the EU AI Act and GDPR.',
                'empty.results': 'Please complete the assessment first.',
                'empty.measures': 'Please complete the assessment first.',
                'btn.export': 'üìÑ Export Assessment (CSV)',
                'btn.reset': 'üîÑ New Assessment',
                'result.riskAssessment': 'Risk Assessment',
                'result.riskScore': 'Risk Score',
                'result.projectType': 'Project Type',
                'result.recommendedMeasures': 'Recommended Measures',
                'result.assessmentDetails': 'Assessment Details',
                'result.aiTool': 'AI Tool',
                'result.aiUseCase': 'AI Use Case',
                'result.dataType': 'Data Type',
                'result.autonomy': 'Autonomy Level',
                'result.impact': 'Impact',
                'result.transparency': 'Transparency',
                'measures.title': 'Recommended Measures',
                'risk.minimal': 'Minimal Risk',
                'risk.low': 'Low Risk',
                'risk.medium': 'Medium Risk',
                'risk.high': 'High Risk',
                'risk.critical': 'Critical Risk',
                languageBtn: 'üá©üá™ Deutsch'
            },
            de: {
                headerTitle: 'P3 AI Risk Assessment Tool',
                headerSubtitle: 'Strategische Bewertung von KI-Systemen f√ºr Consulting-Projekte',
                'tab.assessment': 'Assessment',
                'tab.results': 'Risiko-Analyse',
                'tab.measures': 'Empfehlungen',
                'section.context': 'Projekt & KI-System Kontext',
                'section.properties': 'KI-System Eigenschaften',
                'label.projectType': 'Projekttyp / Bereich:',
                'label.aiTool': 'KI-Tool / System:',
                'label.aiUseCase': 'KI-Anwendungsfall:',
                'label.dataType': 'Verarbeitete Datentypen:',
                'label.autonomy': 'Autonomiegrad:',
                'label.impact': 'Auswirkungsbereich:',
                'label.transparency': 'KI-System Transparenz:',
                'option.pleaseSelect': 'Bitte w√§hlen...',
                'option.strategy': 'Strategieberatung & Business Development',
                'option.digitalTransformation': 'Digitale Transformation',
                'option.processOptimization': 'Prozessoptimierung & Change Management',
                'option.softwareDevelopment': 'Softwareentwicklung & Implementation',
                'option.dataAnalytics': 'Data Analytics & AI Solutions',
                'option.automotive': 'Automotive Engineering & Mobility',
                'option.internalOperations': 'Interne P3-Operationen',
                'option.m365Copilot': 'M365 Copilot',
                'option.aiBuilder': 'AI Builder in Power Platform',
                'option.chatgpt': 'ChatGPT (OpenAI)',
                'option.gpt4': 'GPT-4 / GPT-4o (OpenAI)',
                'option.claude': 'Claude (Anthropic)',
                'option.gemini': 'Google Gemini / Bard',
                'option.githubCopilot': 'GitHub Copilot',
                'option.azureOpenai': 'Azure OpenAI Service',
                'option.awsBedrock': 'AWS Bedrock',
                'option.huggingface': 'HuggingFace Models',
                'option.midjourney': 'Midjourney / DALL-E (Bildgenerierung)',
                'option.jasper': 'Jasper AI',
                'option.notionAi': 'Notion AI',
                'option.perplexity': 'Perplexity AI',
                'option.otherAI': 'Anderes KI-System',
                'option.clientAdvisory': 'Client Advisory & Insight Generation',
                'option.predictiveAnalytics': 'Predictive Analytics & Forecasting',
                'option.automation': 'Prozessautomatisierung',
                'option.decisionSupport': 'Decision Support System',
                'option.nlpAnalysis': 'NLP & Document Analysis',
                'option.codeGeneration': 'Code Generation & Testing',
                'option.resourceAllocation': 'Resource & Project Allocation',
                'option.riskAssessment': 'Risk Assessment & Compliance',
                'option.publicOnly': 'Ausschlie√ülich √∂ffentliche Daten',
                'option.companyGeneral': 'Allgemeine Unternehmensdaten (anonymisiert)',
                'option.clientConfidential': 'Vertrauliche Kundendaten',
                'option.strategicSensitive': 'Strategisch sensible Informationen',
                'option.personalData': 'Personenbezogene Daten (Mitarbeiter/Kunden)',
                'option.specialCategories': 'Besondere Kategorien personenbezogener Daten',
                'option.supportOnly': 'Unterst√ºtzung: KI generiert Vorschl√§ge/Insights',
                'option.interactive': 'Interaktiv: KI kommuniziert mit Stakeholdern',
                'option.semiAutomated': 'Semi-automatisiert: KI trifft Vorentscheidungen',
                'option.automated': 'Automatisiert: KI trifft finale Entscheidungen',
                'option.criticalAutomated': 'Kritisch: KI trifft Entscheidungen mit hoher Tragweite',
                'option.internalEfficiency': 'Interne Effizienz (low impact)',
                'option.projectSupport': 'Projektunterst√ºtzung (medium impact)',
                'option.clientDeliverable': 'Client Deliverable (high impact)',
                'option.strategicDecision': 'Strategische Entscheidungsgrundlage',
                'option.criticalOperations': 'Kritische Gesch√§ftsprozesse',
                'option.transparencyHigh': 'Hoch: Entscheidungen vollst√§ndig nachvollziehbar',
                'option.transparencyMedium': 'Mittel: Wesentliche Faktoren erkl√§rbar',
                'option.transparencyLow': 'Gering: Black-Box System',
                'info.note': 'Hinweis:',
                'info.disclaimer': 'Dieses Tool bietet eine erste Einsch√§tzung zur Risikobewertung von KI-Systemen im Kontext der P3-Beratungsprojekte unter Ber√ºcksichtigung des EU AI Acts und DSGVO.',
                'empty.results': 'Bitte f√ºhren Sie zun√§chst das Assessment durch.',
                'empty.measures': 'Bitte f√ºhren Sie zun√§chst das Assessment durch.',
                'btn.export': 'üìÑ Assessment exportieren (CSV)',
                'btn.reset': 'üîÑ Neues Assessment',
                'result.riskAssessment': 'Risiko-Bewertung',
                'result.riskScore': 'Risk Score',
                'result.projectType': 'Projekttyp',
                'result.recommendedMeasures': 'Empfohlene Ma√ünahmen',
                'result.assessmentDetails': 'Assessment Details',
                'result.aiTool': 'KI-Tool',
                'result.aiUseCase': 'KI-Anwendungsfall',
                'result.dataType': 'Datentyp',
                'result.autonomy': 'Autonomiegrad',
                'result.impact': 'Impact',
                'result.transparency': 'Transparenz',
                'measures.title': 'Empfohlene Ma√ünahmen',
                'risk.minimal': 'Minimales Risiko',
                'risk.low': 'Geringes Risiko',
                'risk.medium': 'Mittleres Risiko',
                'risk.high': 'Hohes Risiko',
                'risk.critical': 'Kritisches Risiko',
                languageBtn: 'üá¨üáß English'
            }
        };

        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'de' : 'en';
            localStorage.setItem('language', currentLanguage);
            updateLanguage();
            
            // Re-render results if assessment exists
            if (currentAssessment) {
                updateResults(currentAssessment);
            }
        }

        function updateLanguage() {
            const lang = translations[currentLanguage];
            
            // Update header
            document.getElementById('headerTitle').textContent = lang.headerTitle;
            document.getElementById('headerSubtitle').textContent = lang.headerSubtitle;
            
            // Update language button
            document.getElementById('languageBtn').textContent = lang.languageBtn;
            
            // Update tabs
            document.querySelector('[data-tab="assessment"]').textContent = lang['tab.assessment'];
            document.querySelector('[data-tab="results"]').textContent = lang['tab.results'];
            document.querySelector('[data-tab="measures"]').textContent = lang['tab.measures'];
            
            // Update all elements with data-i18n attribute
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (lang[key]) {
                    element.textContent = lang[key];
                }
            });
            
            // Update info boxes
            if (currentLanguage === 'de') {
                document.getElementById('infoBox1').innerHTML = `
                    <strong>‚ö†Ô∏è P3 AI Policy:</strong> Aktuell sind nur folgende KI-Tools f√ºr den Einsatz freigegeben:
                    <ul style="margin: 10px 0 0 0; padding-left: 20px;">
                        <li><strong>AI Builder in Power Platform</strong> - f√ºr Automatisierung und intelligente Workflows</li>
                        <li><strong>M365 Copilot</strong> - f√ºr Produktivit√§tssteigerung in Microsoft 365</li>
                    </ul>
                    Alle anderen KI-Systeme (einschlie√ülich ChatGPT, Claude, GitHub Copilot, etc.) <strong>ben√∂tigen eine IT-Genehmigung</strong> vor der Nutzung. Bitte kontaktieren Sie die IT-Abteilung f√ºr eine Bewertung.
                `;
            } else {
                document.getElementById('infoBox1').innerHTML = `
                    <strong>‚ö†Ô∏è P3 AI Policy:</strong> Currently, only the following AI tools are approved for use:
                    <ul style="margin: 10px 0 0 0; padding-left: 20px;">
                        <li><strong>AI Builder in Power Platform</strong> - for automation and intelligent workflows</li>
                        <li><strong>M365 Copilot</strong> - for productivity enhancement in Microsoft 365</li>
                    </ul>
                    All other AI systems (including ChatGPT, Claude, GitHub Copilot, etc.) <strong>require IT approval</strong> before use. Please contact the IT department for assessment.
                `;
            }
            
            // Update AI Tool dropdown optgroup labels
            updateAIToolDropdown();
            
            document.documentElement.lang = currentLanguage;
        }
        
        function updateAIToolDropdown() {
            const select = document.getElementById('aiTool');
            const selectedValue = select.value;
            const lang = translations[currentLanguage];
            
            const approvedLabel = currentLanguage === 'de' ? '‚úÖ Freigegebene Tools' : '‚úÖ Approved Tools';
            const requiresApprovalLabel = currentLanguage === 'de' ? '‚ö†Ô∏è Ben√∂tigt IT-Genehmigung' : '‚ö†Ô∏è Requires IT Approval';
            
            select.innerHTML = `
                <option value="" data-i18n="option.pleaseSelect">${lang['option.pleaseSelect']}</option>
                <optgroup label="${approvedLabel}">
                    <option value="m365_copilot" data-i18n="option.m365Copilot">${lang['option.m365Copilot']}</option>
                    <option value="ai_builder" data-i18n="option.aiBuilder">${lang['option.aiBuilder']}</option>
                </optgroup>
                <optgroup label="${requiresApprovalLabel}">
                    <option value="chatgpt" data-i18n="option.chatgpt">${lang['option.chatgpt']}</option>
                    <option value="gpt4" data-i18n="option.gpt4">${lang['option.gpt4']}</option>
                    <option value="claude" data-i18n="option.claude">${lang['option.claude']}</option>
                    <option value="gemini" data-i18n="option.gemini">${lang['option.gemini']}</option>
                    <option value="github_copilot" data-i18n="option.githubCopilot">${lang['option.githubCopilot']}</option>
                    <option value="azure_openai" data-i18n="option.azureOpenai">${lang['option.azureOpenai']}</option>
                    <option value="aws_bedrock" data-i18n="option.awsBedrock">${lang['option.awsBedrock']}</option>
                    <option value="huggingface" data-i18n="option.huggingface">${lang['option.huggingface']}</option>
                    <option value="midjourney" data-i18n="option.midjourney">${lang['option.midjourney']}</option>
                    <option value="jasper" data-i18n="option.jasper">${lang['option.jasper']}</option>
                    <option value="notion_ai" data-i18n="option.notionAi">${lang['option.notionAi']}</option>
                    <option value="perplexity" data-i18n="option.perplexity">${lang['option.perplexity']}</option>
                    <option value="other" data-i18n="option.otherAI">${lang['option.otherAI']}</option>
                </optgroup>
            `;
            
            // Restore the selected value if it existed
            if (selectedValue) {
                select.value = selectedValue;
            }
        }

        function showTab(tabName) {
            // Update tab content visibility
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
                tab.setAttribute('aria-selected', 'false');
            });
            document.getElementById(tabName).classList.add('active');
            
            // Activate the corresponding tab button
            const tabButton = document.querySelector(`.tab[data-tab="${tabName}"]`);
            if (tabButton) {
                tabButton.classList.add('active');
                tabButton.setAttribute('aria-selected', 'true');
            }
        }
        
        function getSelectedValues(selectId) {
            const select = document.getElementById(selectId);
            if (select.multiple) {
                return Array.from(select.selectedOptions).map(option => option.value).filter(value => value !== '');
            } else {
                return select.value;
            }
        }

        function getCombinedDataScore(dataTypes) {
            if (!Array.isArray(dataTypes) || dataTypes.length === 0) return 0;
            return Math.max(...dataTypes.map(type => DATA_SCORES[type] || 0));
        }
        
        function getSelectedLabels(selectId) {
            const select = document.getElementById(selectId);
            if (select.multiple) {
                return Array.from(select.selectedOptions).map(option => option.text).filter(text => !text.includes('...'));
            } else {
                const selectedOption = select.options[select.selectedIndex];
                return selectedOption ? selectedOption.text : '';
            }
        }

        function calculateRisk() {
            const projectType = getSelectedValues('projectType');
            const aiTool = getSelectedValues('aiTool');
            const aiUseCases = getSelectedValues('aiUseCase');
            const dataTypes = getSelectedValues('dataType');
            const autonomy = getSelectedValues('autonomy');
            const impact = getSelectedValues('impact');
            const transparency = getSelectedValues('transparency');
            
            if (!projectType || !aiTool || aiUseCases.length === 0 || dataTypes.length === 0 || !autonomy || !impact || !transparency) {
                return;
            }
            
            currentAssessment = performAssessment(projectType, aiTool, aiUseCases, dataTypes, autonomy, impact, transparency);
            updateResults(currentAssessment);
            
            // Automatically navigate to results tab when form is complete
            setTimeout(() => {
                showTab('results');
                // Scroll to top of page for better user experience
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, AUTO_NAVIGATION_DELAY_MS);
        }

        function performAssessment(projectType, aiTool, aiUseCases, dataTypes, autonomy, impact, transparency) {
            let riskScore = 0;
            let measures = [];
            
            // Check if tool requires approval
            if (!APPROVED_AI_TOOLS.includes(aiTool)) {
                riskScore += 3;
                measures.push({
                    title: currentLanguage === 'de' ? 'üö® IT-GENEHMIGUNG ERFORDERLICH' : 'üö® IT APPROVAL REQUIRED',
                    description: currentLanguage === 'de' 
                        ? 'Dieses KI-System ist nicht freigegeben! Gem√§√ü P3 AI Policy muss dieses Tool vor dem Einsatz durch die IT-Abteilung gepr√ºft und genehmigt werden. Bitte kontaktieren Sie das IT-Team f√ºr eine Bewertung.'
                        : 'This AI system is not approved! According to P3 AI Policy, this tool must be reviewed and approved by the IT department before deployment. Please contact the IT team for an assessment.'
                });
            }
            
            riskScore += AUTONOMY_SCORES[autonomy] || 0;
            
            const maxDataScore = getCombinedDataScore(dataTypes);
            riskScore += maxDataScore;
            
            riskScore += IMPACT_SCORES[impact] || 0;
            
            if (transparency === 'low') riskScore += 2;
            else if (transparency === 'medium') riskScore += 1;
            
            let riskLevel = 'minimal';
            if (!APPROVED_AI_TOOLS.includes(aiTool) || riskScore >= 13) riskLevel = 'critical';
            else if (riskScore >= 10) riskLevel = 'high';
            else if (riskScore >= 7) riskLevel = 'medium';
            else if (riskScore >= 4) riskLevel = 'low';
            
            measures = generateMeasures(riskLevel, aiTool, autonomy, dataTypes, impact, transparency, aiUseCases, measures);
            
            return {
                riskLevel,
                riskScore,
                projectType,
                aiTool,
                aiUseCases,
                dataTypes,
                autonomy,
                impact,
                transparency,
                measures
            };
        }

        function generateMeasures(riskLevel, aiTool, autonomy, dataTypes, impact, transparency, aiUseCases, measures) {
            const isGerman = currentLanguage === 'de';
            
            if (APPROVED_AI_TOOLS.includes(aiTool)) {
                measures.push({
                    title: isGerman ? '‚úÖ P3-freigegebenes Tool' : '‚úÖ P3-approved Tool',
                    description: isGerman 
                        ? 'Dieses KI-System ist gem√§√ü P3 AI Policy freigegeben und kann nach Beachtung der Sicherheits- und Compliance-Richtlinien eingesetzt werden.'
                        : 'This AI system is approved according to P3 AI Policy and can be deployed following security and compliance guidelines.'
                });
            }
            
            if (riskLevel === 'critical') {
                measures.push({
                    title: isGerman ? 'Hochrisiko-System gem√§√ü EU AI Act' : 'High-risk System under EU AI Act',
                    description: isGerman 
                        ? 'Umfassende Konformit√§tsbewertung erforderlich. Dokumentation aller technischen Spezifikationen, Risikomanagement und Qualit√§tssicherung.'
                        : 'Comprehensive conformity assessment required. Documentation of all technical specifications, risk management and quality assurance.'
                });
                measures.push({
                    title: isGerman ? 'Executive Approval' : 'Executive Approval',
                    description: isGerman 
                        ? 'Projekt erfordert Freigabe durch P3 Management und ggf. Client C-Level vor Deployment.'
                        : 'Project requires approval from P3 Management and possibly client C-Level before deployment.'
                });
            }
            
            if (riskLevel === 'high' || riskLevel === 'critical') {
                measures.push({
                    title: 'Human Oversight',
                    description: isGerman 
                        ? 'Implementierung eines robusten Human-in-the-Loop Systems. Kritische KI-Entscheidungen m√ºssen von qualifizierten Consultants validiert werden.'
                        : 'Implementation of a robust Human-in-the-Loop system. Critical AI decisions must be validated by qualified consultants.'
                });
                measures.push({
                    title: 'Bias & Fairness Testing',
                    description: isGerman 
                        ? 'Systematische √úberpr√ºfung auf Verzerrungen und Diskriminierung. Besonders wichtig bei Entscheidungen mit personellem Impact.'
                        : 'Systematic review for bias and discrimination. Especially important for decisions with personnel impact.'
                });
            }
            
            if (dataTypes.includes('personal_data') || dataTypes.includes('special_categories')) {
                measures.push({
                    title: isGerman ? 'DSGVO Compliance' : 'GDPR Compliance',
                    description: isGerman 
                        ? 'Data Protection Impact Assessment (DPIA) durchf√ºhren. Rechtsgrundlage pr√ºfen, Betroffenenrechte sicherstellen.'
                        : 'Conduct Data Protection Impact Assessment (DPIA). Review legal basis, ensure data subject rights.'
                });
                measures.push({
                    title: isGerman ? 'Data Minimization' : 'Data Minimization',
                    description: isGerman 
                        ? 'Nur absolut notwendige Daten verarbeiten. Anonymisierung/Pseudonymisierung wo m√∂glich implementieren.'
                        : 'Process only absolutely necessary data. Implement anonymization/pseudonymization where possible.'
                });
            }
            
            if (dataTypes.includes('client_confidential') || dataTypes.includes('strategic_sensitive')) {
                measures.push({
                    title: isGerman ? 'Vertraulichkeit & IP-Schutz' : 'Confidentiality & IP Protection',
                    description: isGerman 
                        ? 'NDA-Compliance sicherstellen. Bei externen KI-Services: On-Premise oder Private-Cloud L√∂sung bevorzugen. Data Residency Requirements pr√ºfen.'
                        : 'Ensure NDA compliance. For external AI services: prefer on-premise or private cloud solutions. Review data residency requirements.'
                });
            }
            
            if (transparency === 'low') {
                measures.push({
                    title: 'Explainability Enhancement',
                    description: isGerman 
                        ? 'Explainable AI Techniken implementieren (LIME, SHAP). Dokumentation der Modell-Logik f√ºr Client Transparency.'
                        : 'Implement Explainable AI techniques (LIME, SHAP). Document model logic for client transparency.'
                });
            }
            
            if (autonomy === 'automated' || autonomy === 'critical_automated') {
                measures.push({
                    title: 'Monitoring & Audit Trail',
                    description: isGerman 
                        ? 'Continuous Monitoring der KI-Entscheidungen. Vollst√§ndige Logging-Infrastruktur f√ºr Audits und Fehleranalyse.'
                        : 'Continuous monitoring of AI decisions. Complete logging infrastructure for audits and error analysis.'
                });
            }
            
            if (aiUseCases.includes('risk_assessment')) {
                measures.push({
                    title: isGerman ? 'Validierung & Backtesting' : 'Validation & Backtesting',
                    description: isGerman 
                        ? 'Regelm√§√üige Validierung der Risk-Assessment-Modelle gegen Real-World Outcomes. Confidence Intervals transparent kommunizieren.'
                        : 'Regular validation of risk assessment models against real-world outcomes. Communicate confidence intervals transparently.'
                });
            }
            
            if (aiUseCases.includes('code_generation')) {
                measures.push({
                    title: 'Security Review',
                    description: isGerman 
                        ? 'Code-Reviews f√ºr KI-generierten Code verpflichtend. Security Scanning und Vulnerability Assessment integrieren.'
                        : 'Mandatory code reviews for AI-generated code. Integrate security scanning and vulnerability assessment.'
                });
            }
            
            measures.push({
                title: isGerman ? 'Dokumentation & Governance' : 'Documentation & Governance',
                description: isGerman 
                    ? 'AI Model Card erstellen: Zweck, Limitationen, Training Data, Performance Metrics. Version Control f√ºr Model Updates.'
                    : 'Create AI Model Card: purpose, limitations, training data, performance metrics. Version control for model updates.'
            });
            
            measures.push({
                title: 'Stakeholder Communication',
                description: isGerman 
                    ? 'Transparente Kommunikation √ºber KI-Einsatz gegen√ºber Kunden und betroffenen Personen. Klare Verantwortlichkeiten definieren.'
                    : 'Transparent communication about AI deployment to clients and affected persons. Define clear responsibilities.'
            });
            
            return measures;
        }

        function updateResults(assessment) {
            const lang = translations[currentLanguage];
            const riskClass = `risk-${assessment.riskLevel}`;
            const riskLabel = lang[`risk.${assessment.riskLevel}`];
            
            // Generate risk level explanation
            const riskExplanations = {
                'minimal': currentLanguage === 'de' 
                    ? 'Das KI-System stellt nur ein minimales Risiko dar. Es k√∂nnen Standardsicherheitsma√ünahmen angewendet werden.'
                    : 'The AI system poses only minimal risk. Standard security measures can be applied.',
                'low': currentLanguage === 'de'
                    ? 'Das KI-System hat ein geringes Risiko. Grundlegende √úberwachung und Dokumentation sind erforderlich.'
                    : 'The AI system has low risk. Basic monitoring and documentation are required.',
                'medium': currentLanguage === 'de'
                    ? 'Das KI-System hat ein mittleres Risiko. Erweiterte Kontrollen und regelm√§√üige √úberpr√ºfungen sind notwendig.'
                    : 'The AI system has medium risk. Enhanced controls and regular reviews are necessary.',
                'high': currentLanguage === 'de'
                    ? 'Das KI-System hat ein hohes Risiko. Umfassende Risikomanagement-Ma√ünahmen und kontinuierliche √úberwachung sind erforderlich.'
                    : 'The AI system has high risk. Comprehensive risk management measures and continuous monitoring are required.',
                'critical': currentLanguage === 'de'
                    ? 'Das KI-System hat ein kritisches Risiko. Vollst√§ndige Compliance-Bewertung, Management-Genehmigung und strenge Kontrollen sind zwingend erforderlich.'
                    : 'The AI system has critical risk. Full compliance assessment, management approval, and strict controls are mandatory.'
            };
            
            const autonomyScore = AUTONOMY_SCORES[assessment.autonomy] || 0;
            const dataScore = getCombinedDataScore(assessment.dataTypes);
            const impactScore = IMPACT_SCORES[assessment.impact] || 0;
            const transparencyScore = assessment.transparency === 'low' ? 2 : (assessment.transparency === 'medium' ? 1 : 0);
            const toolApprovalScore = APPROVED_AI_TOOLS.includes(assessment.aiTool) ? 0 : 3;
            
            // Generate compliance requirements
            let complianceReqs = [];
            if (assessment.dataTypes.includes('personal_data') || assessment.dataTypes.includes('special_categories')) {
                complianceReqs.push(currentLanguage === 'de' ? 'DSGVO/GDPR Compliance' : 'GDPR Compliance');
            }
            if (assessment.riskLevel === 'critical' || assessment.riskLevel === 'high') {
                complianceReqs.push(currentLanguage === 'de' ? 'EU AI Act - Hochrisiko-System' : 'EU AI Act - High-Risk System');
            }
            if (!APPROVED_AI_TOOLS.includes(assessment.aiTool)) {
                complianceReqs.push(currentLanguage === 'de' ? 'P3 IT-Genehmigung erforderlich' : 'P3 IT Approval Required');
            }
            if (assessment.dataTypes.includes('client_confidential') || assessment.dataTypes.includes('strategic_sensitive')) {
                complianceReqs.push('NDA Compliance');
            }
            
            document.getElementById('resultsContent').innerHTML = `
                <div class="result-card">
                    <div class="result-header">
                        <div class="result-title">${lang['result.riskAssessment']}</div>
                        <span class="risk-badge ${riskClass}">${riskLabel}</span>
                    </div>
                    <p style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 6px; line-height: 1.6;">
                        ${riskExplanations[assessment.riskLevel]}
                    </p>
                    <p style="margin-top: 15px;"><strong>${lang['result.riskScore']}:</strong> ${assessment.riskScore}/${MAX_RISK_SCORE}</p>
                    <p><strong>${lang['result.projectType']}:</strong> ${getSelectedLabels('projectType')}</p>
                    <p><strong>${lang['result.recommendedMeasures']}:</strong> ${assessment.measures.length}</p>
                </div>
                
                <div class="result-card">
                    <div class="result-title">${currentLanguage === 'de' ? 'Risikoanalyse nach Kategorien' : 'Risk Breakdown by Category'}</div>
                    <div style="margin-top: 15px;">
                        <div style="display: flex; justify-content: space-between; padding: 10px; background: #f8f9fa; margin-bottom: 8px; border-radius: 4px;">
                            <span><strong>${currentLanguage === 'de' ? 'Autonomiegrad' : 'Autonomy Level'}:</strong></span>
                            <span>${autonomyScore}/5 ${currentLanguage === 'de' ? 'Punkte' : 'points'}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px; background: #f8f9fa; margin-bottom: 8px; border-radius: 4px;">
                            <span><strong>${currentLanguage === 'de' ? 'Datensensibilit√§t' : 'Data Sensitivity'}:</strong></span>
                            <span>${dataScore}/5 ${currentLanguage === 'de' ? 'Punkte' : 'points'}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px; background: #f8f9fa; margin-bottom: 8px; border-radius: 4px;">
                            <span><strong>${currentLanguage === 'de' ? 'Auswirkungsbereich' : 'Impact Scope'}:</strong></span>
                            <span>${impactScore}/5 ${currentLanguage === 'de' ? 'Punkte' : 'points'}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px; background: #f8f9fa; margin-bottom: 8px; border-radius: 4px;">
                            <span><strong>${currentLanguage === 'de' ? 'Transparenzmangel' : 'Transparency Gap'}:</strong></span>
                            <span>${transparencyScore}/2 ${currentLanguage === 'de' ? 'Punkte' : 'points'}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px; background: #f8f9fa; margin-bottom: 8px; border-radius: 4px;">
                            <span><strong>${currentLanguage === 'de' ? 'Tool-Genehmigungsstatus' : 'Tool Approval Status'}:</strong></span>
                            <span>${toolApprovalScore}/3 ${currentLanguage === 'de' ? 'Punkte' : 'points'}</span>
                        </div>
                    </div>
                </div>
                
                <div class="result-card">
                    <div class="result-title">${currentLanguage === 'de' ? 'Datensensibilit√§ts-Analyse' : 'Data Sensitivity Analysis'}</div>
                    <p style="margin-top: 10px;"><strong>${currentLanguage === 'de' ? 'Verarbeitete Datentypen' : 'Processed Data Types'}:</strong></p>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        ${getSelectedLabels('dataType').map(label => `<li>${label}</li>`).join('')}
                    </ul>
                    ${assessment.dataTypes.includes('personal_data') || assessment.dataTypes.includes('special_categories') ? `
                        <div style="margin-top: 15px; padding: 12px; background: #fff3cd; border-left: 4px solid #856404; border-radius: 4px;">
                            <strong>‚ö†Ô∏è ${currentLanguage === 'de' ? 'Personenbezogene Daten' : 'Personal Data'}:</strong>
                            ${currentLanguage === 'de' 
                                ? 'DSGVO-Compliance ist erforderlich. Data Protection Impact Assessment (DPIA) muss durchgef√ºhrt werden.'
                                : 'GDPR compliance is required. Data Protection Impact Assessment (DPIA) must be conducted.'}
                        </div>
                    ` : ''}
                    ${assessment.dataTypes.includes('client_confidential') || assessment.dataTypes.includes('strategic_sensitive') ? `
                        <div style="margin-top: 15px; padding: 12px; background: #fff3cd; border-left: 4px solid #856404; border-radius: 4px;">
                            <strong>‚ö†Ô∏è ${currentLanguage === 'de' ? 'Vertrauliche Daten' : 'Confidential Data'}:</strong>
                            ${currentLanguage === 'de'
                                ? 'Besondere Vertraulichkeitsma√ünahmen und NDA-Compliance erforderlich.'
                                : 'Special confidentiality measures and NDA compliance required.'}
                        </div>
                    ` : ''}
                </div>
                
                <div class="result-card">
                    <div class="result-title">${currentLanguage === 'de' ? 'Compliance-Anforderungen' : 'Compliance Requirements'}</div>
                    ${complianceReqs.length > 0 ? `
                        <ul style="margin: 15px 0; padding-left: 20px;">
                            ${complianceReqs.map(req => `<li style="margin-bottom: 8px;">${req}</li>`).join('')}
                        </ul>
                    ` : `
                        <p style="margin-top: 10px; color: #28a745;">
                            ‚úÖ ${currentLanguage === 'de' 
                                ? 'Standard-Compliance-Anforderungen gelten.'
                                : 'Standard compliance requirements apply.'}
                        </p>
                    `}
                </div>
                
                <div class="result-card">
                    <div class="result-title">${lang['result.assessmentDetails']}</div>
                    <p><strong>${lang['result.aiTool']}:</strong> ${getSelectedLabels('aiTool')}</p>
                    <p><strong>${lang['result.aiUseCase']}:</strong> ${getSelectedLabels('aiUseCase').join(', ')}</p>
                    <p><strong>${lang['result.dataType']}:</strong> ${getSelectedLabels('dataType').join(', ')}</p>
                    <p><strong>${lang['result.autonomy']}:</strong> ${getSelectedLabels('autonomy')}</p>
                    <p><strong>${lang['result.impact']}:</strong> ${getSelectedLabels('impact')}</p>
                    <p><strong>${lang['result.transparency']}:</strong> ${getSelectedLabels('transparency')}</p>
                </div>
            `;
            
            let measuresHTML = `<h3 class="section-title">${lang['measures.title']}</h3>`;
            assessment.measures.forEach((measure, index) => {
                measuresHTML += `
                    <div class="measure-item">
                        <div class="measure-title">${index + 1}. ${measure.title}</div>
                        <div>${measure.description}</div>
                    </div>
                `;
            });
            
            document.getElementById('measuresContent').innerHTML = measuresHTML;
        }

        function downloadPDF() {
            if (!currentAssessment) {
                alert(currentLanguage === 'de' 
                    ? 'Bitte f√ºhren Sie zun√§chst das Assessment durch.' 
                    : 'Please complete the assessment first.');
                return;
            }
            
            const aiUseCasesLabel = getSelectedLabels('aiUseCase').join(' | ');
            const dataTypesLabel = getSelectedLabels('dataType').join(' | ');
            const lang = translations[currentLanguage];
            
            const rows = [
                currentLanguage === 'de' ? 'Kategorie;Wert' : 'Category;Value',
                `${currentLanguage === 'de' ? 'Risikostufe' : 'Risk Level'};${lang[`risk.${currentAssessment.riskLevel}`]}`,
                `Risk Score;${currentAssessment.riskScore}/${MAX_RISK_SCORE}`,
                `${lang['result.projectType']};${getSelectedLabels('projectType')}`,
                `${lang['result.aiTool']};${getSelectedLabels('aiTool')}`,
                `${lang['result.aiUseCase']};"${aiUseCasesLabel.replace(/"/g, '""')}"`,
                `${lang['result.dataType']};"${dataTypesLabel.replace(/"/g, '""')}"`,
                `${lang['result.autonomy']};${getSelectedLabels('autonomy')}`,
                `${lang['result.impact']};${getSelectedLabels('impact')}`,
                `${lang['result.transparency']};${getSelectedLabels('transparency')}`,
                '',
                lang['measures.title']
            ];
            
            currentAssessment.measures.forEach((measure, index) => {
                rows.push(`${index + 1}. ${measure.title};"${measure.description.replace(/"/g, '""')}"`);
            });
            
            const bom = new Uint8Array([0xEF, 0xBB, 0xBF]);
            const blob = new Blob([bom, rows.join('\n')], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `P3_AI_Risk_Assessment_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
        }

        function resetForm() {
            document.querySelectorAll('select').forEach(select => {
                if (select.multiple) {
                    Array.from(select.options).forEach(option => option.selected = false);
                } else {
                    select.value = '';
                }
            });
            
            currentAssessment = null;
            const lang = translations[currentLanguage];
            
            document.getElementById('resultsContent').innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon">üìä</div>
                    <p>${lang['empty.results']}</p>
                </div>
            `;
            
            document.getElementById('measuresContent').innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon">‚úÖ</div>
                    <p>${lang['empty.measures']}</p>
                </div>
            `;
            
            showTab('assessment');
        }

        // Initialize language and theme on page load
        window.onload = function() {
            // Initialize theme first
            initializeTheme();
            
            const savedLanguage = localStorage.getItem('language');
            if (savedLanguage) {
                currentLanguage = savedLanguage;
            }
            updateLanguage();
            
            // Add scroll animations with IntersectionObserver
            observeElements();
        };
        
        // Intersection Observer for scroll-triggered animations
        function observeElements() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            });
            
            document.querySelectorAll('.form-section, .result-card, .measure-item').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1), transform 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                observer.observe(el);
            });
        }
    </script>
</body>
</html>
